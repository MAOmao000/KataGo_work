https://github.com/mateidavid/zstr.git
rev 6811097c924346e463b058d63684629bcc5651e0

MODIFIED locally by katago authors with a few further changes and fixes.